{"version":3,"sources":["plugins/osu-db-loader.js"],"names":["OSUDBLoader","name","weight","type","mute","init","OSUService","setDBInstance","DBInstance","createTable","trx","schema","hasTable","table","increments","primary","integer","string","text","withTransaction"],"mappings":"oLAAA;AACA;AACA,6E;;;;;;;;AAQMA,W,WANL,oBAAO,EACNC,IAAI,EAAE,eADA,EAENC,MAAM,EAAE,CAFF,EAGNC,IAAI,EAAE,IAHA,EAGM;AACZC,EAAAA,IAAI,EAAE,IAJA,EAAP,C,2BAAD,MAMMJ,WANN,CAMkB,CAChBK,IAAI,GAAG;AACLC,wBAAWC,aAAX,CAAyB,KAAKC,UAA9B;AACD;;;AAGKC,EAAAA,WADN,CACkBC,GADlB,EACuB;AACrB,UAAI,QAAQA,GAAG,CAACC,MAAJ,CAAWC,QAAX,CAAoB,UAApB,CAAR,CAAJ,EAA8C;AAC5C,cAAMF,GAAG,CAACC,MAAJ,CAAWF,WAAX,CAAuB,UAAvB,EAAoCI,KAAD,IAAW;AAClDA,UAAAA,KAAK,CAACC,UAAN,CAAiB,IAAjB,EAAuBC,OAAvB;AACAF,UAAAA,KAAK,CAACG,OAAN,CAAc,SAAd;AACAH,UAAAA,KAAK,CAACG,OAAN,CAAc,UAAd;AACAH,UAAAA,KAAK,CAACG,OAAN,CAAc,QAAd;AACAH,UAAAA,KAAK,CAACI,MAAN,CAAa,UAAb;AACAJ,UAAAA,KAAK,CAACG,OAAN,CAAc,MAAd;AACD,SAPK,CAAN;AAQD;AACD,UAAI,QAAQN,GAAG,CAACC,MAAJ,CAAWC,QAAX,CAAoB,SAApB,CAAR,CAAJ,EAA6C;AAC3C,cAAMF,GAAG,CAACC,MAAJ,CAAWF,WAAX,CAAuB,SAAvB,EAAmCI,KAAD,IAAW;AACjDA,UAAAA,KAAK,CAACG,OAAN,CAAc,IAAd;AACAH,UAAAA,KAAK,CAACK,IAAN,CAAW,KAAX;AACD,SAHK,CAAN;AAID,OAhBoB;AAiBtB,GAvBe,C,gEAKfC,mB;;;AAqBYnB,W","sourcesContent":["import { Plugin } from '../decorators/plugin';\nimport { withTransaction } from '../decorators/db';\nimport OSUService from '../services/osu-service';\n\n@Plugin({\n  name: 'osu-db-loader',\n  weight: 1,\n  type: null, // 类型为空, 不添加到插件队列内\n  mute: true\n})\nclass OSUDBLoader {\n  init() {\n    OSUService.setDBInstance(this.DBInstance);\n  }\n\n  @withTransaction\n  async createTable(trx) {\n    if (!(await trx.schema.hasTable('osu_bind'))) {\n      await trx.schema.createTable('osu_bind', (table) => {\n        table.increments('id').primary();\n        table.integer('user_id');\n        table.integer('group_id');\n        table.integer('osu_id');\n        table.string('osu_name');\n        table.integer('mode');\n      });\n    }\n    if (!(await trx.schema.hasTable('osu_map'))) {\n      await trx.schema.createTable('osu_map', (table) => {\n        table.integer('id');\n        table.text('map');\n      });\n    }\n  }\n}\n\nexport default OSUDBLoader;\n"],"file":"osu-db-loader.js","sourceRoot":"/Users/zcwsr/my/japari-admin/src"}