{"version":3,"sources":["plugins/commands/help.js"],"names":["Help","name","command","type","info","default","level","getCommandInstance","commandName","body","commandMap","isAdmin","Config","ADMINS","indexOf","user_id","commandInstance","showOne","instance","showAll","content","Object","keys","forEach","run","params","QQService","sendGroupMessage","group_id","sendPrivateMessage"],"mappings":"iJAAA;AACA;AACA,8E;;;;;;;;;;AAUMA,I,WARL,qBAAQ,EACPC,IAAI,EAAE,IADC,EAEPC,OAAO,EAAE,MAFF,EAGPC,IAAI,EAAE,KAHC,EAIPC,IAAI,EAAE,0CAJC,EAKPC,OAAO,EAAE,IALF,EAMPC,KAAK,EAAE,CANA,EAAR,C,gBAAD,MAQMN,IARN,CAQW;AACTO,EAAAA,kBAAkB,CAACC,WAAD,EAAcC,IAAd,EAAoBC,UAApB,EAAgC;AAChD,UAAMC,OAAO,GAAGC,gBAAOC,MAAP,CAAcC,OAAd,CAAsB,CAACL,IAAI,CAACM,OAA5B,IAAuC,CAAC,CAAxD;AACA,UAAMC,eAAe,GAAGN,UAAU,CAACF,WAAD,CAAlC;AACA,QAAIQ,eAAe,CAACV,KAAhB,KAA0B,CAA9B,EAAiC;AAC/B,aAAOK,OAAO,GAAGK,eAAH,GAAqB,IAAnC;AACD;AACD,WAAOA,eAAP;AACD;;AAEDC,EAAAA,OAAO,CAACT,WAAD,EAAcC,IAAd,EAAoBC,UAApB,EAAgC;AACrC,UAAMQ,QAAQ,GAAG,KAAKX,kBAAL,CAAwBC,WAAxB,EAAqCC,IAArC,EAA2CC,UAA3C,CAAjB;AACA,QAAIQ,QAAJ,EAAc;AACJjB,MAAAA,IADI,GACoBiB,QADpB,CACJjB,IADI,CACEC,OADF,GACoBgB,QADpB,CACEhB,OADF,CACWE,IADX,GACoBc,QADpB,CACWd,IADX;AAEZ,aAAQ,QAAOH,IAAK,cAAaC,OAAQ,SAAQE,IAAI,IAAI,KAAM,EAA/D;AACD;AACD,WAAQ,MAAKI,WAAY,UAAzB;AACD;;AAEDW,EAAAA,OAAO,CAACV,IAAD,EAAOC,UAAP,EAAmB;AACxB,QAAIU,OAAO,GAAG,8BAAd;AACAC,IAAAA,MAAM,CAACC,IAAP,CAAYZ,UAAZ,EAAwBa,OAAxB,CAAiCtB,IAAD,IAAU;AACxC,YAAMiB,QAAQ,GAAG,KAAKX,kBAAL,CAAwBN,IAAxB,EAA8BQ,IAA9B,EAAoCC,UAApC,CAAjB;AACA,UAAIQ,QAAJ,EAAc;AACZE,QAAAA,OAAO,IAAK,MAAKF,QAAQ,CAAChB,OAAQ,KAAIgB,QAAQ,CAACjB,IAAT,IAAiB,EAAG,EAA1D;AACD;AACF,KALD;AAMA,WAAOmB,OAAP;AACD;;AAEDI,EAAAA,GAAG,CAACC,MAAD,EAAShB,IAAT,EAAeN,IAAf,EAAqBO,UAArB,EAAiC;AAClC,UAAMF,WAAW,GAAGiB,MAApB;AACA,QAAIL,OAAJ;AACA,QAAIZ,WAAJ,EAAiB;AACfY,MAAAA,OAAO,GAAG,KAAKH,OAAL,CAAaT,WAAb,EAA0BC,IAA1B,EAAgCC,UAAhC,CAAV;AACD,KAFD,MAEO;AACLU,MAAAA,OAAO,GAAG,KAAKD,OAAL,CAAaV,IAAb,EAAmBC,UAAnB,CAAV;AACD;AACD,QAAIP,IAAI,KAAK,OAAb,EAAsB;AACpBuB,yBAAUC,gBAAV,CAA2BlB,IAAI,CAACmB,QAAhC,EAA0CR,OAA1C;AACD,KAFD,MAEO,IAAIjB,IAAI,KAAK,SAAb,EAAwB;AAC7BuB,yBAAUG,kBAAV,CAA6BpB,IAAI,CAACM,OAAlC,EAA2CK,OAA3C;AACD;AACF,GA3CQ,C;;;AA8CIpB,I","sourcesContent":["import Config from '../../config';\nimport { Command } from '../../decorators/plugin';\nimport QQService from '../../services/qq-service';\n\n@Command({\n  name: '帮助',\n  command: 'help',\n  type: 'all',\n  info: \"用来查看所有指令或者某特定指令的使用方法的指令, '!help 指令名' 来调用\",\n  default: true,\n  level: 1\n})\nclass Help {\n  getCommandInstance(commandName, body, commandMap) {\n    const isAdmin = Config.ADMINS.indexOf(+body.user_id) > -1;\n    const commandInstance = commandMap[commandName];\n    if (commandInstance.level === 3) {\n      return isAdmin ? commandInstance : null;\n    }\n    return commandInstance;\n  }\n\n  showOne(commandName, body, commandMap) {\n    const instance = this.getCommandInstance(commandName, body, commandMap);\n    if (instance) {\n      const { name, command, info } = instance;\n      return `指令名: ${name}\\ncommand: ${command}\\n描述: ${info || '无描述'}`;\n    }\n    return `指令'${commandName}'不存在或被隐藏`;\n  }\n\n  showAll(body, commandMap) {\n    let content = \"可用指令: (使用'!help 指令名'可查看详细用法)\";\n    Object.keys(commandMap).forEach((name) => {\n      const instance = this.getCommandInstance(name, body, commandMap);\n      if (instance) {\n        content += `\\n!${instance.command}  ${instance.name || ''}`;\n      }\n    });\n    return content;\n  }\n\n  run(params, body, type, commandMap) {\n    const commandName = params;\n    let content;\n    if (commandName) {\n      content = this.showOne(commandName, body, commandMap);\n    } else {\n      content = this.showAll(body, commandMap);\n    }\n    if (type === 'group') {\n      QQService.sendGroupMessage(body.group_id, content);\n    } else if (type === 'private') {\n      QQService.sendPrivateMessage(body.user_id, content);\n    }\n  }\n}\n\nexport default Help;\n"],"file":"help.js","sourceRoot":"/Users/zcwsr/my/japari-admin/src"}