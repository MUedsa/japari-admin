{"version":3,"sources":["plugins/commands/osu-bp.js"],"names":["OSUBp","name","command","type","info","run","params","body","groupId","group_id","QQService","sendGroupMessage","replace","split","osuName","bpIndex","parseInt","mode","userInfo","OSUService","getInstance","getUserByName","bpInfo","getBP","username","osuId","user_id","sendInfo"],"mappings":"kOAAA;AACA;AACA,gF;;;;;;;;;;AAUMA,K,WARL,qBAAQ,EACPC,IAAI,EAAE,WADC,EAEPC,OAAO,EAAE,IAFF,EAGPC,IAAI,EAAE,OAHC,EAIPC,IAAI,EAAG;;sDAJA,EAAR,C,gBAAD,MAQMJ,KARN,CAQY,CACJK,GAAN,CAAUC,MAAV,EAAkBC,IAAlB,EAAwB,8CACJC,OADI,GACQD,IADR,CACdE,QADc;AAEtB,UAAI,CAACH,MAAL,EAAa;AACXI,2BAAUC,gBAAV,CAA2BH,OAA3B,EAAoC,4BAApC;AACA;AACD;AACDF,MAAAA,MAAM,GAAGA,MAAM,CAACM,OAAP,CAAe,GAAf,EAAoB,GAApB,CAAT;AACAN,MAAAA,MAAM,GAAGA,MAAM,CAACO,KAAP,CAAa,GAAb,CAAT;AACA,YAAMC,OAAO,GAAGR,MAAM,CAAC,CAAD,CAAtB;AACA,UAAI,CAACQ,OAAL,EAAc;AACZJ,2BAAUC,gBAAV,CAA2BH,OAA3B,EAAoC,eAApC;AACA;AACD;AACD,YAAMO,OAAO,GAAGC,QAAQ,CAACV,MAAM,CAAC,CAAD,CAAN,IAAa,CAAd,EAAiB,EAAjB,CAAxB;AACA,UAAIS,OAAO,GAAG,EAAV,IAAgBA,OAAO,GAAG,CAA9B,EAAiC;AAC/BL,2BAAUC,gBAAV,CAA2BH,OAA3B,EAAoC,4BAApC;AACA;AACD;AACD,YAAMS,IAAI,GAAGD,QAAQ,CAACV,MAAM,CAAC,CAAD,CAAN,IAAa,CAAd,EAAiB,EAAjB,CAArB;AACA,UAAIW,IAAI,KAAK,CAAT,IAAcA,IAAI,KAAK,CAAvB,IAA4BA,IAAI,KAAK,CAArC,IAA0CA,IAAI,KAAK,CAAvD,EAA0D;AACxDP,2BAAUC,gBAAV,CAA2BH,OAA3B,EAAoC,oBAApC;AACA;AACD;AACD,YAAMU,QAAQ,SAASC,oBAAWC,WAAX,GAAyBC,aAAzB,CAAuCP,OAAvC,EAAgDG,IAAhD,CAAvB;AACA,UAAI,OAAOC,QAAP,KAAoB,QAAxB,EAAkC;AAChCR,2BAAUC,gBAAV,CAA2BH,OAA3B,EAAoCU,QAApC;AACA;AACD;AACD,YAAMI,MAAM,SAASH,oBAAWC,WAAX,GAAyBG,KAAzB;AACnB;AACET,QAAAA,OAAO,EAAEI,QAAQ,CAACM,QADpB;AAEEC,QAAAA,KAAK,EAAE,CAACP,QAAQ,CAACQ,OAFnB;AAGET,QAAAA,IAHF,EADmB;;AAMnBF,MAAAA,OANmB,CAArB;;AAQA,UAAI,OAAOO,MAAP,KAAkB,QAAtB,EAAgC;AAC9BZ,2BAAUC,gBAAV,CAA2BH,OAA3B,EAAoCc,MAApC;AACA;AACD;AACD,YAAMH,oBAAWC,WAAX,GAAyBO,QAAzB,CAAmC,MAAKZ,OAAQ,EAAhD,EAAmDO,MAAnD,EAA2Dd,OAA3D,CAAN,CAxCsB;AAyCvB,GA1CS,C;;;AA6CGR,K","sourcesContent":["import { Command } from '../../decorators/plugin';\nimport QQService from '../../services/qq-service';\nimport OSUService from '../../services/osu-service';\n\n@Command({\n  name: '查询osu! bp',\n  command: 'bp',\n  type: 'group',\n  info: `查询某特定账号的bp数据, '!bp 玩家名,第几bp,mode'来调用\n  第几bp不传默认为第一bp, mode不写默认为osu!模式\n  模式代码: (0 = osu!, 1 = Taiko, 2 = CtB, 3 = osu!mania)`\n})\nclass OSUBp {\n  async run(params, body) {\n    const { group_id: groupId } = body;\n    if (!params) {\n      QQService.sendGroupMessage(groupId, \"缺少查询参数, 使用'!help bp'查看调用方式\");\n      return;\n    }\n    params = params.replace('，', ',');\n    params = params.split(',');\n    const osuName = params[0];\n    if (!osuName) {\n      QQService.sendGroupMessage(groupId, '非法参数, 请输入玩家昵称');\n      return;\n    }\n    const bpIndex = parseInt(params[1] || 1, 10);\n    if (bpIndex > 20 || bpIndex < 0) {\n      QQService.sendGroupMessage(groupId, '非法参数, 仅支持bp查询范围#1-#20, 请重试');\n      return;\n    }\n    const mode = parseInt(params[2] || 0, 10);\n    if (mode !== 0 && mode !== 2 && mode !== 1 && mode !== 3) {\n      QQService.sendGroupMessage(groupId, '非法参数, 请不要写不存在的模式谢谢');\n      return;\n    }\n    const userInfo = await OSUService.getInstance().getUserByName(osuName, mode);\n    if (typeof userInfo === 'string') {\n      QQService.sendGroupMessage(groupId, userInfo);\n      return;\n    }\n    const bpInfo = await OSUService.getInstance().getBP(\n      {\n        osuName: userInfo.username,\n        osuId: +userInfo.user_id,\n        mode\n      },\n      bpIndex\n    );\n    if (typeof bpInfo === 'string') {\n      QQService.sendGroupMessage(groupId, bpInfo);\n      return;\n    }\n    await OSUService.getInstance().sendInfo(`bp#${bpIndex}`, bpInfo, groupId);\n  }\n}\n\nexport default OSUBp;\n"],"file":"osu-bp.js","sourceRoot":"/Users/zcwsr/my/japari-admin/src"}